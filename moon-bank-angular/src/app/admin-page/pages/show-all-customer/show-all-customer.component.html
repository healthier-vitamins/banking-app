<!-- <div *ngIf="!!listOfBankAcc" class="m-3 border px-4 py-5 rounded">
  <table class="table table-sm table-bordered table-striped table-hover border">
    <thead class="text-light text-center" style="background-color: #40417d">
      <tr>
        <th scope="col" class="">#</th>
        <th scope="col">Email</th>
        <th scope="col">First Name</th>
        <th scope="col">Last Name</th>
        <th scope="col">Phone</th>
        <th scope="col">City</th>
        <th scope="col">Account Balance</th>
        <th scope="col">Account Type</th>
        <th scope="col">Date Created</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let acc of listOfBankAcc; index as i">
        <th scope="row">&nbsp;{{ i + 1 }}&nbsp;</th>
        <td>{{ acc.customer.custEmail }}</td>
        <td>{{ acc.customer.custFirstName }}</td>
        <td>{{ acc.customer.custLastName }}</td>
        <td>{{ acc.customer.custPhone }}</td>
        <td>{{ acc.customer.custCity }}</td>
        <td>${{ acc.accBal }}</td>
        <td>{{ acc.accType }}</td>
        <td>{{ acc.accCreationDate }}</td>
        <td class="text-center">
          <i class="bi bi-pencil-square me-1 text-secondary"></i
          ><i class="bi bi-trash-fill text-secondary"></i>
        </td>
      </tr>
    </tbody>
  </table>
</div> -->
<!-- <div class="d-flex"   *ngIf="!listOfBankAcc">
  <div class="spinner-grow text-primary" id="loading-ball1" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <div class="spinner-grow text-success" id="loading-ball2" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <div class="spinner-grow text-danger" id="loading-ball3" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <div class="spinner-grow text-warning" id="loading-ball4" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div> -->

<!-- <div class="m-3 mt-4 p-4 border rounded">
  <div
    class="d-inline-flex border border-bottom-0 rounded-top mb-0 px-4 pt-1"
    *ngIf="!!listOfBankAcc"
  >
    <h5>
      <i
        class="bi bi-arrow-clockwise text-secondary"
        style="font-size: 18px"
        (click)="refresh()"
      ></i>
    </h5>
    <i
      class="bi bi-plus-square text-secondary ms-2"
      routerLink="/admin/create-customer"
    ></i>
  </div>
  <table
    *ngIf="!!listOfBankAcc"
    mat-table
    [dataSource]="listOfBankAcc"
    class="mt-0"
    style="width: 100%"
  >
    <ng-container matColumnDef="#">
      <th
        mat-header-cell
        *matHeaderCellDef
        class="text-center"
        id="firstHeader"
      >
        #
      </th>
      <td mat-cell *matCellDef="let element" id="body" class="text-center">
        <i
          class="bi bi-pencil-square text-secondary me-1"
          (click)="edit(element)"
        ></i
        ><i
          class="bi bi-trash-fill text-secondary"
          (click)="delBankAcc(element)"
        ></i>
      </td>
    </ng-container>
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef id="header">Email</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.customer.custEmail }}
      </td>
    </ng-container>
    <ng-container matColumnDef="firstName">
      <th mat-header-cell *matHeaderCellDef id="header">First Name</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.customer.custFirstName }}
      </td>
    </ng-container>
    <ng-container matColumnDef="lastName">
      <th mat-header-cell *matHeaderCellDef id="header">Last Name</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.customer.custLastName }}
      </td>
    </ng-container>
    <ng-container matColumnDef="phone">
      <th mat-header-cell *matHeaderCellDef id="header">Phone</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.customer.custPhone }}
      </td>
    </ng-container>
    <ng-container matColumnDef="city">
      <th mat-header-cell *matHeaderCellDef id="header">City</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.customer.custCity }}
      </td>
    </ng-container>
    <ng-container matColumnDef="accBal">
      <th mat-header-cell *matHeaderCellDef id="header">Account Balance</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.accBal }}
      </td>
    </ng-container>
    <ng-container matColumnDef="accType">
      <th mat-header-cell *matHeaderCellDef id="header">Account Type</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.accType }}
      </td>
    </ng-container>
    <ng-container matColumnDef="dateCreated">
      <th mat-header-cell *matHeaderCellDef id="header">Date Created</th>
      <td mat-cell *matCellDef="let element" id="body">
        {{ element.accCreationDate }}
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</div> -->
<div class="m-3 mt-4 p-4 border rounded">
  <div class="table-container">
    <div
      class="d-inline-flex border border-bottom-0 rounded-top mb-0 px-4 pt-1"
      *ngIf="!!listOfBankAcc"
    >
      <h5>
        <i
          class="bi bi-arrow-clockwise text-secondary"
          style="font-size: 18px"
          (click)="refresh()"
        ></i>
      </h5>
      <i
        class="bi bi-plus-square text-secondary ms-2"
        routerLink="/admin/create-customer"
      ></i>
    </div>
    <table mat-table [dataSource]="listOfBankAcc" multiTemplateDataRows>
      <ng-container matColumnDef="#">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-center"
          id="firstHeader"
        >
          #
        </th>
        <td mat-cell *matCellDef="let element" id="body" class="text-center">
          <i
            class="bi bi-pencil-square text-secondary me-1"
            (click)="edit(element)"
          ></i
          ><i
            class="bi bi-trash-fill text-secondary"
            (click)="delBankAcc(element)"
          ></i>
        </td>
      </ng-container>
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef id="header">Email</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.customer.custEmail }}
        </td>
      </ng-container>
      <ng-container matColumnDef="firstName">
        <th mat-header-cell *matHeaderCellDef id="header">First Name</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.customer.custFirstName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="lastName">
        <th mat-header-cell *matHeaderCellDef id="header">Last Name</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.customer.custLastName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="phone">
        <th mat-header-cell *matHeaderCellDef id="header">Phone</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.customer.custPhone }}
        </td>
      </ng-container>
      <ng-container matColumnDef="city">
        <th mat-header-cell *matHeaderCellDef id="header">City</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.customer.custCity }}
        </td>
      </ng-container>
      <ng-container matColumnDef="accBal">
        <th mat-header-cell *matHeaderCellDef id="header">Account Balance</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.accBal }}
        </td>
      </ng-container>
      <ng-container matColumnDef="accType">
        <th mat-header-cell *matHeaderCellDef id="header">Account Type</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.accType }}
        </td>
      </ng-container>
      <ng-container matColumnDef="dateCreated">
        <th mat-header-cell *matHeaderCellDef id="header">Date Created</th>
        <td mat-cell *matCellDef="let element" id="body">
          {{ element.accCreationDate }}
        </td>
      </ng-container>
      <ng-container matColumnDef="expand">
        <th
          mat-header-cell
          *matHeaderCellDef
          aria-label="row actions"
          id="header"
        >
          Offers
        </th>
        <td mat-cell *matCellDef="let element">
          <button
            *ngIf="element.customer.offers.length > 0"
            mat-icon-button
            aria-label="expand row"
            (click)="
              expandedElement = expandedElement === element ? null : element;
              $event.stopPropagation()
            "
            class="offer-btn"
          >
            <mat-icon *ngIf="expandedElement !== element"
              >keyboard_arrow_down</mat-icon
            >
            <mat-icon *ngIf="expandedElement === element"
              >keyboard_arrow_up</mat-icon
            >
          </button>
        </td>
      </ng-container>

      <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
      <ng-container matColumnDef="expandedDetail">
        <td
          mat-cell
          *matCellDef="let element"
          [attr.colspan]="columnsToDisplayWithExpand.length"
        >
          <div
            class="element-detail"
            [@detailExpand]="
              element == expandedElement ? 'expanded' : 'collapsed'
            "
          >
            <div>
              {{ expandedHelper(element) }}
              <div *ngFor="let offer of listOfOffers">
                <table class="expanded-table">
                  <tr>
                    <th
                      *ngFor="let columnName of expandedColumns"
                      class="expanded-header-th"
                    >
                      {{ columnName }}
                    </th>
                  </tr>
                  <tr>
                    <td class="expanded-body-td">{{ offer.offerName }}</td>
                    <td class="expanded-body-td">{{ offer.annualFee }}</td>
                    <td class="expanded-body-td">{{ offer.loanAmnt }}</td>
                    <td class="expanded-body-td">
                      {{ offer.interestFreeCashWithdrawal }}
                    </td>
                    <td class="expanded-body-td">
                      {{ offer.interestRatePercent }}%
                    </td>
                    <td class="expanded-body-td">
                      {{ offer.preclosureCharges }}
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
      <tr
        mat-row
        *matRowDef="let element; columns: columnsToDisplayWithExpand"
        class="element-row"
        [class.expanded-row]="expandedElement === element"
        (click)="expandedElement = expandedElement === element ? null : element"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['expandedDetail']"
        class="detail-row"
      ></tr>
    </table>
  </div>
</div>
